# AI 입법 수요 분석 서비스 모델 — Readme

> **목표**: 뉴스 및 소셜 데이터에서 법률 관련 이슈의 **중요도 평가**와
**입법 수요 예측**을 수행하는 파이프라인을 설계·구현하고, 월 단위로 추적 가능한 대시보드로 서비스한다.



## 전체 파이프라인 개요

아래 그림은 본 프로젝트의 파이프라인이다. 뉴스와 소셜을 **분리-최적화된 파이프라인**으로 처리한 뒤, 4대 법률 카테고리별 토픽 프로필을 생성하고 **PI/II/MBI** 지수를 통해 **PFI(입법 수요 종합 점수)**를 도출한다.

<img width="722" height="863" alt="image" src="https://github.com/user-attachments/assets/9f626893-1487-413f-9ffb-91b2dec767d4" />




## 활용 데이터

- **뉴스 (약 28,000건)**  
  - 수집 방식: 기존 *법률 키워드*를 기반으로 크롤링된 기사.
  - 특성: 대부분이 실제 법률 이슈와 직접적으로 연관되어 있어 **추가 필터링 없이** 텍스트 전처리 후 모델링에 사용.

- **소셜 (약 240,000건)** — *트위터, 인스타그램, 블로그, 커뮤니티* 포함  
  - 관찰된 노이즈: 단순 뉴스 복붙, 법률 이슈와 무관한 운영 규칙/홍보 글 등이 다수.
  - **대표성 높은 채널 선별 + 노이즈 필터링**:
    - 트위터, 커뮤니티(네이버 카페 제외)를 대상으로 **층화추출**을 적용하여 *트위터 1,000건 · 커뮤니티 1,000건*을 **무작위 추출**.
    - **수동 라벨링**(법률 이슈=1, 무관=0)으로 필터를 학습/검증하여 **법률 관련 여론**에 초점을 맞춤.

- **라벨링 샘플(층화추출 1,000 + 1,000)**
  - `twitter_1000_label_augmented.csv` — 트위터 1,000건에 대한 수동 라벨(법률 이슈=1, 비관련=0)
  - `community_1000_label_augmented.csv` — 커뮤니티 1,000건에 대한 수동 라벨(법률 이슈=1, 비관련=0)
  - 1과 0의 데이터 불균형 이슈로 label = 1 데이터는 샘플링을 통하여 라벨 비율 1:1로 증강

- **전처리 완료 원본**
  - `news_original.csv` — 전처리 완료 뉴스 코퍼스
  - `social_original.csv` — 전처리 완료 소셜 코퍼스(전체 기간 중 **법률 이슈 관련 데이터만** 필터링)
  - `news_social_combined.csv` — 뉴스·소셜 결합 데이터(분석·시각화 편의용)

- **토픽 결과 & 최종 지수**
  - `news_results/` — NTM 결과(군집/키워드/시계열 집계 등)
 
    


## 모델 개발 방법


### 1) 뉴스 데이터 파이프라인 (NTM: News Topic Modeling)

1. **텍스트 전처리**: 정규화(공백/제어문자 제거), 한글/숫자/기본 구두점 유지, 불필요 토큰 정리.
2. **도메인 전용 임베딩(인코더) 파인튜닝**  
   - 접근: **TSDAE** 사전학습으로 뉴스 코퍼스 구조를 학습 → (필요 시) NLI/STS 등 지도학습으로 미세조정.  
   - 결과 모델 식별자: `finetuned_tsdae_news` (뉴스 전용 인코더).
3. **차원축소 + 클러스터링**  
   - **UMAP**으로 밀도 기반 구조를 보존하며 축소, **HDBSCAN**으로 군집 수 자동 추정 및 노이즈 분리.
4. **키워드/대표문 구성**  
   - **KeyBERT**를 통해 각 군집의 핵심 키워드와 대표문을 추출 → **시계열 토픽(NTM)** 생성.
5. **시간 축 매핑**  
   - 기사 발행일 기준으로 토픽의 발생/지속/강도를 **월 단위 시계열**로 집계.


### 2) 소셜 데이터 파이프라인 (STM: Social Topic Modeling)

1. **사전 노이즈 제어**: (트위터·커뮤니티) 층화추출 1,000+1,000, **수동 라벨링(1/0)**로 법률 이슈 식별 → 필터링 규칙/모델 구성.
2. **텍스트 전처리**: 이모지·해시태그·URL 처리, 구어체/축약 정규화, 중복·리트윗류 정리.
3. **도메인 전용 임베딩(인코더) 파인튜닝**  
   - 접근: 소셜 어투/짧은 문장·은어 반영을 위해 **TSDAE**로 사전학습 → (필요 시) 태스크 기반 지도 미세조정.  
   - 결과 모델 식별자: `finetuned_tsdae_social` (소셜 전용 인코더).
4. **차원축소 + 클러스터링**: **UMAP + HDBSCAN** (뉴스 파이프라인과 동일).
5. **키워드/대표문 구성**: **KeyBERT**로 핵심 키워드 추출 → **시계열 토픽(STM)** 생성.
6. **시간 축 매핑**: 게시 시각 기반 월 단위 집계.

- **대각선(자기 유사도)**이 1.0으로 선명하고, **오프-대각(상호 유사도)**가 거의 0에 가까워  
  **토픽 분리도**가 높음 → NTM·STM 모두 **중복 없이 잘 구분**됨.
- 드문 **오프-대각의 옅은 반점**은 “법률·산업 일반어(예: 제정, 개정, 위반, 처벌, 시장, 투자)” 같은  
  **범용 키워드 공유**에서 기인한 것으로 보이며, 전반적 품질에 영향 미미.
  

### 3) 토픽 프로필 생성 (News × Social × 4 Categories)

- **법률 카테고리 (4)**:
  1) 개인정보보호법, 2) 중대재해처벌법, 3) 아동복지법, 4) 자본시장법  
- **소스 (2)**: 뉴스(NTM), 소셜(STM)

각 카테고리×소스 조합으로 **총 8개의 토픽 프로필**을 구성한다.  
토픽은 시간축으로 관측 가능하며, 각 시점(월)에 대해 문서수, 키워드, 대표문, 예시 링크 등 메타정보를 유지한다.

  - `social_results/` — STM 결과(군집/키워드/시계열 집계 등)
  - `legislative_demand_index_final.csv` — **PFI(입법 수요 종합 점수)** 최종 기록 파일


### 4) 입법 수요 지수 설계

토픽의 **지속성·강도·최근 모멘텀**을 결합해 **PFI(Policy Fit/Priority Index)**를 산출한다.

- **PI (Persistence Index)** — *지속성/연속성*  
  - 정의(예시): 최근 *W*개월 동안의 발생률/빈도에 대한 이동평균 + 연속 발생 패널티/보너스.
- **II (Intensity Index)** — *절대 강도(문서수/저변)*  
  - 정의: 시점별 (문서수, 고유 작성자수 등)을 정규화·스케일링한 강도 점수.
- **MBI (Momentum/Burst Index)** — *최근 모멘텀/급증*  
  - 정의: 최근 *w*개월 기울기(Δ) + **burstiness**(예: moving z-score, ESD) 결합.

- **PFI (Policy Fit / Priority Index)** — *입법 수요 종합 점수*  
  - 결합식(예시):  
$$
\text{PFI}_t = \alpha \cdot \text{PI}_t + \beta \cdot \text{II}_t + \gamma \cdot \text{MBI}_t
$$

$$
\alpha = 3.5,\quad \beta = 3.5,\quad \gamma = 3.0 \quad \text{으로 초기 설정 후, 실험을 통해 지수별 분류가 최적인 가중치를 부여하였다.}
$$

> 산출된 PFI에 따라 토픽을 **입법대응 최우선 / 중점 모니터링 / 관심 지속 / 단기 이슈**로 분류한다.


### 5) 후처리 및 서비스

- **KONPLY 후처리**: 한국어 복합 명사/표기 변형/외래어를 정규화하여 **키워드 품질을 개선**.
- **대시보드 (월간 토픽 트래킹)**:
  - 카테고리·소스별 **PFI 순위**와 시계열 차트, 토픽 키워드/대표문 제공.
  - 토픽 유형 라벨: **입법대응 최우선 / 중점 모니터링 / 관심 지속 / 단기 이슈**.
  - 필터(기간/지수) 및 법률 정보 검색(국회법률정보시스템 연동) 지원

- **웹 대시보드 예시 사진**
- <img width="1910" height="854" alt="image" src="https://github.com/user-attachments/assets/83a4446c-c28d-43dd-8e4b-eb9cc93f2464" />




## 실험 및 평가

### A. 토픽 모델링 품질
- **응집도/분리도**: Silhouette/NMI(정답 없을 때는 정성 평가 병행), **토픽 코히런스**(c_npmi/umass)로 비교.
- **도메인 전용 임베딩 효과**: `finetuned_tsdae_*` vs. 범용 임베딩(베이스라인) **Ablation**.
- **Jaccard Heatmap**로 본 NTM·STM 품질 검증

### B. 지수(PFI) 타당성
- **PI–MBI 분포**로 지수 타당성 분석

> 수치 결과는 데이터 공개 범위에 따라 별도 부록/대시보드에서 확인하도록 구성한다.

### A. Jaccard Heatmap로 본 NTM·STM 품질 검증

### 1) Jaccard 유사도란?
두 집합 \(A, B\) 사이의 겹치는 정도를 0~1 사이 값으로 측정하는 지표입니다.  

$$
J(A,B)=\frac{|A \cap B|}{|A \cup B|}


$$
- **1에 가까울수록** 두 집합이 거의 동일(높은 겹침)
- **0에 가까울수록** 공통 원소가 거의 없음

본 프로젝트에서는 **토픽 키워드 집합**(또는 대표 문서의 키워드 집합)을 집합 \(A,B\)로 두고, **토픽 간** 유사도를 계산했습니다.
- 아래는 자본시장법의 NTM과 STM의 Jaccard Heatmap 입니다. (다른 법률의 자료는 figure에 있습니다.)
<img width="2040" height="2040" alt="image" src="https://github.com/user-attachments/assets/945e34c1-b202-4abb-9a63-126fc2af2265" />

<img width="1120" height="928" alt="image" src="https://github.com/user-attachments/assets/dfed0aba-44ac-4396-a258-712f4e66aab4" />

**관찰 포인트**
- **대각선(자기 유사도)**이 1.0으로 선명하고, **오프-대각(상호 유사도)**가 거의 0에 가까워  
  **토픽 분리도**가 높음 → NTM·STM 모두 **중복 없이 잘 구분**됨.
- 드문 **오프-대각의 옅은 반점**은 “법률·산업 일반어같은  
  **범용 키워드 공유**에서 기인한 것으로 보이며, 전반적 품질에 영향 미미.


  ### B. PI–MBI 분포로 지수 타당성 분석




- **x축=PI(지속성)**, **y축=MBI(모멘텀/급증)**, **버블 크기=II(절대 강도)**
<img width="1160" height="845" alt="image" src="https://github.com/user-attachments/assets/f439c261-d5be-4342-b188-0bea0111e354" />



**관찰 포인트(타당성 근거)**
1. **오른쪽 영역(PI↑)에 포인트가 조밀** → 반복적으로 관측되는 이슈가 다수임을 포착.  
   → PI가 실제 “지속되는 정책 이슈”를 안정적으로 분리함.
2. **상단( MBI↑ )으로 갈수록 최근 급증 이슈가 구분** → 동일 PI에서도 MBI가 **새로운 파고**를 감지.  
   → **지속성**과 **급증성**이 **서로 다른 신호**로 작동.
3. **큰 버블(II↑)**이 Q1·Q4에 많이 분포 → **문서/저변 규모가 큰** 이슈가 우선 영역에 집중.  
   → 강도(II)가 **보정 변수**로 합리적으로 작동.
4. **카테고리 색상 전반에 걸친 분포** → 특정 분야에 치우치지 않고 **범주 간 비교 가능성** 확보.
5. **좌하단(Q3) 희소** → 노이즈/일회성 이슈가 필터링되어 **지수의 선택성**이 높음.


## 재현을 위한 실행 순서

1. **소셜 노이즈 필터링** → `1_social_noise_filter.ipynb`  
   - 층화추출(트위터 1,000 / 커뮤니티 1,000) & 수동 라벨 정의 → 필터 학습/적용.
2. **임베딩 인코더 학습** → `2_encoder_training.ipynb`  
   - 뉴스/소셜 각각 **TSDAE 사전학습 → (선택) 지도 미세조정**으로 `finetuned_tsdae_news`, `finetuned_tsdae_social` 생성.
3. **토픽 모델링(NTM/STM)** → `3_Topic_modeling_STM_NTM.ipynb`  
   - UMAP + HDBSCAN 군집화 → KeyBERT 키워드 추출 → **시계열 토픽** 생성.
4. **토픽 프로필 결합** (News × Social × 4 Categories)  
   - 8개 토픽 프로필 생성 및 메타데이터 정리.  
   - *지수 산출, KONPLY 후처리, 대시보드 구축은 서비스 리포지토리/백엔드 단계에서 연결.*

- 모델 실행 메뉴얼은 각 `ipynb` 파일 최상단 shell에 기재하였습니다.



## 설계 상의 핵심 선택지와 근거
- **입법 수요 예측 기준(사례 기반)**: 과거 실제 입법 사례(예: *전세사기특별법* 등)를 분석한 결과, 여론이 **오랫동안 지속적으로 노출**되고(PI↑), 특정 계기를 기점으로 **이슈가 급증한 뒤 쉽게 꺼지지 않는** 패턴(MBI↑)을 보이며, 동시에 **저변 규모(문서/참여자)가 충분**할 때(II↑) 입법으로 연결되는 경향이 뚜렷했다. 이 관찰을 토대로 본 프로젝트의 **PFI = α·PI + β·II + γ·MBI** 설계를 채택·정당화하였다.

- **뉴스/소셜 분리 학습**: 담화 구조·문체·길이·노이즈 프로파일이 달라 **전용 인코더**가 토픽 분해력 우수.
- **UMAP+HDBSCAN 조합**: 토픽 수 **자동 결정**, 노이즈 견고성, 비선형 매니폴드 보존.
- **KeyBERT**: 군집 대표 키워드 추출이 간단·해석가능, 대시보드 설명력 강화.
- **PFI 3지수 결합**: 단순 빈도(II)만으로는 ‘지속’·‘급증’을 반영하기 어려워 **PI/MBI**를 함께 고려.
- **KONPLY 후처리**: 한국어 표기 변이/동의어 통합으로 **검색·모니터링 품질** 개선.



## 기대효과

- **입법 수요 조기 탐지**: 사회적 관심 급증(소셜)과 제도화 신호(뉴스)를 **동시·상호 보완** 관측.
- **우선순위 의사결정 지원**: **PFI** 기반으로 이슈를 4단계 라벨로 구분해 **대응 자원 배분** 최적화.
- **설명가능성**: 토픽 키워드·대표문·출처 링크 제공으로 **정책 커뮤니케이션** 용이.
- **확장성**: 카테고리·채널·지역·언어 확장 및 모델 교체(예: LLM RAG/질의응답) 용이.
